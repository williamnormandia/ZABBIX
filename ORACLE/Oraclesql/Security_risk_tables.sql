select amount metric,case when amount=0 then 0 else 2 end value from (select count(*) amount from dba_tab_privs WHERE table_name in (select table_name from dict where table_name like 'V$%' or table_name like 'GV$%' or table_name like 'X$%' or table_name in ('LINK$', 'SOURCE$', 'AUD$', 'STATS$SQL_SUMMARY', 'STATS$SQLTEXT', 'DBA_DB_LINKS', 'USER_DB_LINKS', 'ALL_DB_LINKS')) and grantee not in ('DBA', 'SYS', 'SYSTEM', 'SYSMAN', 'AQ_ADMINISTRATOR_ROLE', 'SELECT_CATALOG_ROLE', 'DELETE_CATALOG_ROLE', 'AVUSER') and grantee not in (SELECT username FROM dba_users WHERE account_status <> 'OPEN'));
exit
